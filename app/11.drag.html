---
title: 拖曳
layout: ./app/layout.ejs
engine: ejs
current: index
---

<style>
  .chartContainer {
    margin: auto;
    width: 80%;
    min-width: 200px;
    height: 500px;
    margin: auto;
}
</style>

<h2 class="text-center fw-bold">Drag 拖曳</h2>
<div class="chartContainer"></div>

<script src="https://d3js.org/d3.v7.min.js"></script>
<script>
    // 假資料
    const data = [{name:'A', x:200, y:340},
                  {name:'B', x:220, y:300},
                  {name:'C', x:250, y:198},
                  {name:'D', x:360,y:296},
                  {name:'E', x:160, y:150},
                  {name:'F', x:370, y:360},
                  {name:'G', x:187, y:250}]

    const svg = d3.select('.chartContainer')
                  .append('svg')
                  .attr('width', 500)
                  .attr('height', 500);
    
    // 建立原點，目前全部都在同個位置
    const dots = svg.append('g')
                    .selectAll('circle')
                    .data(data)
                    .enter()
                    .append('circle')
                    .attr('r', 25)
                    .attr('cx', d=>d.x)
                    .attr('cy', d=>d.y)
                    .style("fill", "#19d3a2")
                    .style("fill-opacity", 0.3)
                    .attr("stroke", "#b3a2c8")
                    .style("stroke-width", 4)
                    .style('cursor', 'pointer');

    // 拖曳的方法
    let singleDot = undefined
    const drag = d3.drag()
                   .on('start', function(){
                       singleDot = d3.select(this)
                    })
                   .on('drag', function(){
                       let pt = d3.pointer(event, svg.node()) //v6以後都是改成 pointer 了
                       singleDot.attr('cx', pt[0]).attr('cy', pt[1])
                    })
                   .on('end', function(){
                      singleDot = undefined
                    });
    
    drag(svg.selectAll('circle'));
</script>
